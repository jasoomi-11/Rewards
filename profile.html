<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>User Profile</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}
body{
  background:linear-gradient(135deg,#0b1d61,#08123a);
  color:#fff;
  min-height:100vh;
}

/* Header */
header{
  background:#0a184f;
  padding:14px 22px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  box-shadow:0 6px 20px rgba(0,0,0,.4);
}
.logo{width:48px;height:48px;border-radius:50%;border:2px solid #00e0ff}
.user{
  width:46px;height:46px;border-radius:50%;
  background:#1a2b8f;
  border:2px solid #00e0ff;
  display:flex;align-items:center;justify-content:center;
  font-size:22px;
}

/* Loader */
#loader{
  position:fixed;inset:0;
  background:#08123a;
  display:flex;align-items:center;justify-content:center;
  z-index:999;
}
.spinner{
  width:52px;height:52px;
  border:5px solid rgba(255,255,255,.25);
  border-top:5px solid #00e0ff;
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

/* Main */
.main{
  max-width:900px;
  margin:30px auto;
  padding:0 16px;
  display:none;
}

/* Profile Card */
.profile-card{
  background:linear-gradient(145deg,#1a2b8f,#243bba);
  border-radius:22px;
  padding:24px;
  box-shadow:0 20px 40px rgba(0,0,0,.45);
  margin-bottom:22px;
}
.profile-top{
  display:flex;
  gap:18px;
  align-items:center;
}
.avatar{
  width:70px;height:70px;border-radius:50%;
  background:#00e0ff;
  display:flex;align-items:center;justify-content:center;
  font-size:34px;color:#08123a;
}
.profile-info h2{margin-bottom:4px}
.profile-info small{opacity:.8}

/* Stats Grid */
.stats{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:18px;
  margin-bottom:22px;
}
.stat{
  background:linear-gradient(145deg,#16257a,#1f33a0);
  padding:20px;
  border-radius:18px;
  box-shadow:0 12px 28px rgba(0,0,0,.4);
}
.stat span{font-size:13px;opacity:.85}
.stat strong{font-size:20px}

/* Level Card */
.level-card{
  background:linear-gradient(145deg,#0f9d58,#0bbd6e);
  padding:22px;
  border-radius:20px;
  box-shadow:0 0 28px #0f9d5890;
}
.level-card h3{margin-bottom:6px}
.progress-bar{
  height:14px;
  background:rgba(255,255,255,.3);
  border-radius:12px;
  overflow:hidden;
  margin-top:10px;
}
.progress{
  height:14px;
  background:#ffffff;
  width:0%;
  transition:1s;
}

/* Logout */
.logout{
  margin:30px auto 10px;
  display:block;
  background:#ff4c4c;
  color:#fff;
  border:none;
  padding:14px 36px;
  border-radius:14px;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}

/* Footer */
footer{
  margin-top:40px;
  background:#0a184f;
  padding:18px 10px;
  text-align:center;
  font-size:14px;
  color:#00e0ff;
}
footer a{color:#00e0ff;margin:0 8px;text-decoration:none}
</style>
</head>

<body>

<header>
  <img src="logo.png" class="logo">
  <div class="user">ðŸ‘¤</div>
</header>

<div id="loader"><div class="spinner"></div></div>

<div class="main" id="main">

  <div class="profile-card">
    <div class="profile-top">
      <div class="avatar">ðŸ‘¤</div>
      <div class="profile-info">
        <h2 id="name">User</h2>
        <small id="email">email@example.com</small><br>
        <small>Joined: <span id="joined">-</span></small>
      </div>
    </div>
  </div>

  <div class="stats">
    <div class="stat">
      <span>Total Engagement</span>
      <strong id="engagement">0</strong>
    </div>
    <div class="stat">
      <span>Game Time</span>
      <strong id="gameTime">0 sec</strong>
    </div>
  </div>

  <div class="level-card">
    <h3>Level Progress</h3>
    <strong>Level <span id="level">1</span></strong>
    <div class="progress-bar">
      <div class="progress" id="levelProgress"></div>
    </div>
  </div>

  <button class="logout" id="logoutBtn">Logout</button>

</div>

<footer>
  <p>This app is for entertainment purposes only.</p>
  <a href="#">About</a> |
  <a href="#">Terms & Conditions</a> |
  <a href="#">Privacy Policy</a>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

const app = initializeApp({
  apiKey: "AIzaSyBe3E2eSUaDH5rZHguezaHjbxKmRA5QVd4",
  authDomain: "rewards-b8f54.firebaseapp.com",
  projectId: "rewards-b8f54"
});
const auth = getAuth(app);
const db = getFirestore(app);

const loader = document.getElementById("loader");
const main = document.getElementById("main");

onAuthStateChanged(auth, async user=>{
  if(!user) return location.replace("index.html");

  const snap = await getDoc(doc(db,"users",user.uid));
  if(!snap.exists()) return;

  const d = snap.data();

  document.getElementById("name").textContent = d.name || "User";
  document.getElementById("email").textContent = d.email || "-";
  document.getElementById("joined").textContent =
    d.createdAt?.toDate ? d.createdAt.toDate().toLocaleDateString() : "-";

  document.getElementById("engagement").textContent = d.totalEngagement || 0;
  document.getElementById("gameTime").textContent = (d.gameSeconds||0)+" sec";
  document.getElementById("level").textContent = d.currentLevel || 1;

  document.getElementById("levelProgress").style.width =
    Math.min((d.totalEngagement||0)%100,100)+"%";

  loader.style.display="none";
  main.style.display="block";
});

document.getElementById("logoutBtn").onclick=async()=>{
  await signOut(auth);
  location.replace("index.html");
};
</script>

</body>
</html>